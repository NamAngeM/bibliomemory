================================================================================
BIBLIOTHÃˆQUE NUMÃ‰RIQUE ACADÃ‰MIQUE
Contexte du Projet - SpÃ©cifications Techniques ComplÃ¨tes
================================================================================

VERSION: 1.0.0
DATE: Janvier 2025
STATUT: SpÃ©cifications Initiales
PRIORITÃ‰: Haute

================================================================================
1. PRÃ‰SENTATION DU PROJET
================================================================================

1.1 OBJECTIF GÃ‰NÃ‰RAL
--------------------
DÃ©velopper une plateforme web moderne de consultation publique de rapports de 
stage et mÃ©moires acadÃ©miques, accessible sans authentification, avec un 
systÃ¨me de lecture sÃ©curisÃ©e empÃªchant le tÃ©lÃ©chargement non autorisÃ©.

1.2 MISSION
-----------
Offrir aux Ã©tudiants, chercheurs et au grand public un accÃ¨s libre et gratuit 
Ã  un catalogue de travaux acadÃ©miques (mÃ©moires, thÃ¨ses, rapports de stage) 
pour consultation en ligne uniquement, dans un environnement sÃ©curisÃ© et 
professionnel.

1.3 VALEUR AJOUTÃ‰E
------------------
- âœ… DÃ©mocratisation de l'accÃ¨s aux travaux acadÃ©miques
- âœ… Protection des droits d'auteur (lecture seule)
- âœ… Valorisation des productions estudiantines
- âœ… Aide Ã  la recherche documentaire
- âœ… Inspiration pour les nouveaux Ã©tudiants
- âœ… Rayonnement de l'Ã©tablissement

1.4 CIBLE UTILISATEURS
----------------------
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Type d'utilisateur  â”‚ Besoins                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Visiteurs publics   â”‚ Consulter, rechercher, lire en ligne            â”‚
â”‚ Ã‰tudiants           â”‚ S'inspirer, rechercher des sujets               â”‚
â”‚ Enseignants         â”‚ Orienter les Ã©tudiants, vÃ©rifier les sources    â”‚
â”‚ Chercheurs          â”‚ Documentation, Ã©tat de l'art                     â”‚
â”‚ Administrateurs     â”‚ DÃ©pÃ´t, validation, modÃ©ration, statistiques      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
2. STACK TECHNIQUE RETENUE
================================================================================

2.1 ARCHITECTURE GLOBALE
------------------------
Architecture: Three-tier (Frontend / Backend / Database)
Type: Application Web Progressive (PWA capable)
DÃ©ploiement: Cloud-native (conteneurs Docker)

2.2 FRONTEND
------------
Framework: Next.js 14+ (React 18+)
  Justification: 
    - SEO optimisÃ© pour indexer les titres/mÃ©tadonnÃ©es
    - Server-Side Rendering (SSR) pour performance
    - App Router pour navigation moderne
    - Image optimization intÃ©grÃ©e
    
Language: TypeScript 5+
  Justification: Typage fort, meilleure maintenabilitÃ©

Styling: Tailwind CSS 3+
  Justification: 
    - DÃ©veloppement rapide
    - Design system cohÃ©rent
    - Performance optimale (PurgeCSS)

Composants UI: shadcn/ui
  Justification:
    - Composants accessibles (A11y)
    - Personnalisables
    - BasÃ©s sur Radix UI

State Management: Zustand ou Jotai
  Justification: LÃ©ger, simple, performant

Data Fetching: React Query (TanStack Query)
  Justification:
    - Cache intelligent
    - Gestion des Ã©tats de chargement
    - Synchronisation automatique

Lecteur PDF: PDF.js (Mozilla)
  Justification:
    - Open source, robuste
    - Personnalisable pour dÃ©sactiver tÃ©lÃ©chargement
    - Compatible tous navigateurs

2.3 BACKEND
-----------
Framework: NestJS 10+ (Node.js/TypeScript)
  Justification:
    - Architecture modulaire et scalable
    - TypeScript natif
    - IntÃ©gration facile avec PostgreSQL
    - Ã‰cosystÃ¨me riche (Passport, JWT, etc.)
    - Pattern MVC rigoureux

Alternative: FastAPI (Python 3.11+)
  Si besoins IA/ML: 
    - Traitement de texte avancÃ©
    - Anti-plagiat
    - OCR
    - Classification automatique

ORM: Prisma
  Justification:
    - Type-safe
    - Migrations automatiques
    - Studio GUI intÃ©grÃ©
    - Excellent DX (Developer Experience)

API: RESTful + GraphQL (optionnel)
  Justification:
    - REST pour CRUD simple
    - GraphQL pour requÃªtes complexes/recherche

Documentation: Swagger/OpenAPI
  Justification: Auto-gÃ©nÃ©ration de la doc API

2.4 BASE DE DONNÃ‰ES
-------------------
SGBD: PostgreSQL 15+
  Justification:
    - FiabilitÃ© Ã©prouvÃ©e
    - Relations complexes (auteurs, tuteurs, catÃ©gories)
    - Full-text search natif (pg_trgm)
    - JSON support pour mÃ©tadonnÃ©es flexibles
    - Extensions puissantes
    - Open source

Extensions recommandÃ©es:
  - pg_trgm: Recherche floue (fuzzy search)
  - uuid-ossp: GÃ©nÃ©ration d'UUID
  - citext: Colonnes case-insensitive
  - pgcrypto: Cryptographie

SchÃ©ma de donnÃ©es: Voir section 4

2.5 MOTEUR DE RECHERCHE
-----------------------
Solution: Meilisearch (open source) â­ RECOMMANDÃ‰
  Justification:
    - Ultra rapide (<50ms)
    - Recherche "fuzzy" tolÃ©rante aux fautes
    - Filtres et facettes avancÃ©s
    - Multilingue (FR/EN)
    - Typo-tolerance
    - Auto-hÃ©bergeable
    - Gratuit et open source

Alternative: Algolia (SaaS payant)
  Si budget disponible:
    - Encore plus rapide
    - Analytics intÃ©grÃ©es
    - Support commercial

2.6 STOCKAGE DE FICHIERS
-------------------------
Solution: AWS S3 (Amazon Simple Storage Service) â­ RECOMMANDÃ‰
  Justification:
    - ScalabilitÃ© illimitÃ©e
    - Haute disponibilitÃ© (99.99%)
    - CoÃ»t optimisÃ© (pay-as-you-go)
    - IntÃ©gration CloudFront (CDN)
    - Versioning natif
    - SÃ©curitÃ© robuste (IAM, encryption)

Configuration:
  - Bucket privÃ© (pas d'accÃ¨s public direct)
  - URL signÃ©es temporaires pour lecture
  - Lifecycle policies (archivage automatique)
  - Encryption at rest (AES-256)
  - Cross-region replication (backup)

Alternative: Google Cloud Storage
  Justification similaire Ã  S3

âš ï¸ RÃˆGLE CRITIQUE: 
Jamais de stockage PDF sur le serveur web/backend !
Toujours utiliser un service cloud dÃ©diÃ©.

2.7 CACHE ET FILES D'ATTENTE
-----------------------------
Cache: Redis 7+
  Justification:
    - Cache de sessions
    - Cache de requÃªtes frÃ©quentes
    - Rate limiting
    - Pub/Sub pour notifications

Queue: Bull (BullMQ)
  Justification:
    - TÃ¢ches asynchrones (traitement PDF, OCR)
    - Retry automatique
    - Monitoring intÃ©grÃ©
    - Compatible Redis

2.8 AUTHENTIFICATION (Administrateurs uniquement)
--------------------------------------------------
MÃ©thode: JWT (JSON Web Tokens)
  Justification:
    - Stateless
    - Scalable
    - Standard industrie

Framework: Passport.js
  StratÃ©gies:
    - Local (email/password)
    - OAuth2 (Google, Microsoft - optionnel)

SÃ©curitÃ©:
  - Bcrypt pour hash des mots de passe
  - Refresh tokens
  - Rate limiting sur login
  - CSRF protection

2.9 MONITORING ET LOGS
-----------------------
Erreurs: Sentry
  Justification:
    - Tracking erreurs temps rÃ©el
    - Stack traces dÃ©taillÃ©es
    - Alertes automatiques

Logs: Winston (NestJS)
  Justification:
    - Niveaux de logs configurables
    - Rotation automatique
    - Multiple transports

MÃ©triques: Prometheus + Grafana (optionnel)
  Justification:
    - Monitoring performance
    - Dashboards visuels
    - Alerting

2.10 CI/CD ET DÃ‰PLOIEMENT
--------------------------
Conteneurisation: Docker + Docker Compose
  Justification:
    - Environnements reproductibles
    - DÃ©ploiement simplifiÃ©
    - Isolation des services

Orchestration: Kubernetes (pour production Ã  grande Ã©chelle)
  Alternative: Docker Swarm (plus simple)

CI/CD: GitHub Actions ou GitLab CI
  Justification:
    - Tests automatiques
    - DÃ©ploiement automatique
    - Quality gates

HÃ©bergement recommandÃ©:
  - AWS (EC2, RDS, S3, CloudFront)
  - Google Cloud Platform
  - DigitalOcean (plus Ã©conomique)
  - Vercel (pour Next.js) + Backend sÃ©parÃ©

================================================================================
3. FONCTIONNALITÃ‰S DÃ‰TAILLÃ‰ES
================================================================================

3.1 ACCÃˆS ET CONSULTATION (PUBLIC)
-----------------------------------
âœ… F1.1 - AccÃ¨s sans authentification
  - Page d'accueil publique
  - Navigation libre dans le catalogue
  - Pas de crÃ©ation de compte requise
  - Pas de paywall

âœ… F1.2 - Lecture en ligne sÃ©curisÃ©e
  - Lecteur PDF.js intÃ©grÃ©
  - DÃ©sactivation du clic droit
  - DÃ©sactivation de l'impression
  - DÃ©sactivation du tÃ©lÃ©chargement
  - Blocage de la sÃ©lection de texte
  - Filigrane dynamique affichÃ©
  - Mode plein Ã©cran disponible

âœ… F1.3 - Navigation intuitive
  - Zoom avant/arriÃ¨re
  - Navigation page par page
  - Indicateur de progression
  - Miniatures des pages (optionnel)
  - Recherche de texte dans le document
  - Signets automatiques (si prÃ©sents dans PDF)

3.2 GESTION DES DOCUMENTS (ADMIN)
----------------------------------
âœ… F2.1 - DÃ©pÃ´t de documents
  - Upload par formulaire web
  - Drag & drop
  - Validation format (PDF uniquement)
  - Validation taille (max 50MB par dÃ©faut)
  - VÃ©rification intÃ©gritÃ© fichier
  - Extraction automatique mÃ©tadonnÃ©es (si prÃ©sentes)

âœ… F2.2 - Workflow de validation
  Ã‰tats possibles:
    1. Brouillon (draft) - Non visible public
    2. En attente (pending) - Soumis pour validation
    3. ValidÃ© (approved) - Visible public
    4. RejetÃ© (rejected) - Non publiÃ© avec raison
    5. ArchivÃ© (archived) - Plus visible mais conservÃ©

  Actions admin:
    - Approuver
    - Rejeter avec commentaire
    - Demander modification
    - Archiver
    - Supprimer dÃ©finitivement

âœ… F2.3 - Modification mÃ©tadonnÃ©es
  - Ã‰dition complÃ¨te des mÃ©tadonnÃ©es
  - Correction d'erreurs
  - Ajout de mots-clÃ©s
  - Modification du rÃ©sumÃ©
  - Changement de catÃ©gorie

âœ… F2.4 - Suppression
  - Soft delete (par dÃ©faut)
  - Hard delete (avec confirmation)
  - Historique des suppressions
  - PossibilitÃ© de restauration (soft delete)

3.3 MÃ‰TADONNÃ‰ES OBLIGATOIRES
-----------------------------
ğŸ“‹ Pour chaque document dÃ©posÃ©:

M1. AUTEUR
  - Nom (required, string, max 100 caractÃ¨res)
  - PrÃ©nom (required, string, max 100 caractÃ¨res)
  - Email (optionnel, string, format email)
  - Photo (optionnel, URL)

M2. DOCUMENT
  - Titre (required, string, max 500 caractÃ¨res)
  - RÃ©sumÃ© (required, text, min 100, max 5000 caractÃ¨res)
  - Mots-clÃ©s (required, array, min 3, max 10)
  - Langue (required, enum: FR, EN, ES, AR, etc.)
  - Nombre de pages (auto-extrait du PDF)

M3. ACADÃ‰MIQUE
  - AnnÃ©e acadÃ©mique (required, string, format: "2023-2024")
  - Date de soutenance (required, date)
  - Ã‰tablissement (required, string, liste prÃ©dÃ©finie)
  - FacultÃ©/Institut (required, string, liste prÃ©dÃ©finie)
  - DÃ©partement (optionnel, string)
  - Classe/Niveau (required, string, ex: "Master 2")
  - Cycle (required, enum: Licence, Master, Doctorat, BTS, DUT, etc.)
  - FiliÃ¨re/SpÃ©cialitÃ© (required, string, ex: "Informatique")
  - Sous-filiÃ¨re (optionnel, string, ex: "Intelligence Artificielle")

M4. ENCADREMENT
  - Encadreur acadÃ©mique (required)
    - Nom (required, string)
    - PrÃ©nom (required, string)
    - Grade (required, enum: Professeur, MaÃ®tre de confÃ©rences, etc.)
    - Email (optionnel)
  - Co-encadreur (optionnel, mÃªmes champs)
  - Tuteur entreprise (optionnel, pour stages)
    - Nom
    - PrÃ©nom
    - Entreprise
    - Poste

M5. CLASSIFICATION
  - Domaine principal (required, liste prÃ©dÃ©finie)
  - Sous-domaine (optionnel)
  - Type de document (required, enum: MÃ©moire, ThÃ¨se, Rapport de stage, PFE)
  - ConfidentialitÃ© (required, boolean, default: false)
  - Embargo (optionnel, date de fin si confidentiel)

M6. FICHIER
  - Nom fichier original (auto-rempli)
  - Taille fichier (auto-rempli)
  - Hash SHA-256 (auto-calculÃ©, pour intÃ©gritÃ©)
  - URL S3 (auto-rempli)
  - URL signÃ©e temporaire (gÃ©nÃ©rÃ© Ã  la demande)
  - Date d'upload (auto-rempli)
  - UploadÃ© par (admin_id, auto-rempli)

M7. STATISTIQUES (auto-calculÃ©es)
  - Nombre de vues
  - Nombre de recherches le mentionnant
  - DerniÃ¨re consultation
  - Score de popularitÃ©

3.4 RECHERCHE AVANCÃ‰E (PUBLIC)
-------------------------------
âœ… F4.1 - Recherche full-text
  - Recherche dans titres, rÃ©sumÃ©s, mots-clÃ©s
  - TolÃ©rance aux fautes (fuzzy search)
  - Recherche multilingue
  - Auto-complÃ©tion
  - Suggestions de recherche
  - Correction orthographique

âœ… F4.2 - Filtres multicritÃ¨res
  Filtres disponibles:
    â–¡ Cycle (Licence, Master, Doctorat, etc.)
    â–¡ FiliÃ¨re/SpÃ©cialitÃ© (liste dÃ©roulante)
    â–¡ Ã‰tablissement (checkbox multiple)
    â–¡ FacultÃ© (checkbox multiple)
    â–¡ AnnÃ©e acadÃ©mique (plage ou sÃ©lection multiple)
    â–¡ Auteur (recherche autocomplete)
    â–¡ Encadreur (recherche autocomplete)
    â–¡ Langue (checkbox)
    â–¡ Type de document (checkbox)
    â–¡ Mots-clÃ©s (tags cliquables)
    â–¡ Date de soutenance (plage de dates)

âœ… F4.3 - Tri des rÃ©sultats
  Options de tri:
    - Pertinence (par dÃ©faut)
    - Date de soutenance (rÃ©cent â†’ ancien)
    - Date de soutenance (ancien â†’ rÃ©cent)
    - PopularitÃ© (nombre de vues)
    - Titre (A â†’ Z)
    - Auteur (A â†’ Z)

âœ… F4.4 - Affichage des rÃ©sultats
  - Vue liste (par dÃ©faut)
  - Vue grille (optionnel)
  - Pagination (20 rÃ©sultats par page)
  - Lazy loading (scroll infini optionnel)
  - Highlighting des termes recherchÃ©s
  - Miniature premiÃ¨re page PDF (optionnel)

âœ… F4.5 - Facettes de recherche
  Affichage de:
    - Nombre de rÃ©sultats par cycle
    - Nombre de rÃ©sultats par filiÃ¨re
    - Nombre de rÃ©sultats par annÃ©e
    - Nuage de mots-clÃ©s populaires

3.5 NAVIGATION ET DÃ‰COUVERTE
-----------------------------
âœ… F5.1 - Page d'accueil
  - Recherche rapide
  - Documents rÃ©cents (10 derniers)
  - Documents populaires (top 10)
  - Parcourir par cycle
  - Parcourir par filiÃ¨re
  - Statistiques globales (nombre total de documents)

âœ… F5.2 - Page de dÃ©tail d'un document
  Sections:
    - MÃ©tadonnÃ©es complÃ¨tes
    - RÃ©sumÃ©
    - Mots-clÃ©s (cliquables pour recherche)
    - Informations auteur
    - Informations encadrement
    - Bouton "Lire en ligne"
    - Documents similaires (recommandations)
    - Statistiques (vues)
    - Bouton "Signaler un problÃ¨me"

âœ… F5.3 - Parcourir par catÃ©gorie
  - Page par cycle (tous les documents du cycle)
  - Page par filiÃ¨re
  - Page par Ã©tablissement
  - Page par annÃ©e
  - Filtres toujours disponibles

âœ… F5.4 - Breadcrumbs
  Navigation contextuelle:
    Accueil > Cycle > FiliÃ¨re > Document

3.6 SÃ‰CURITÃ‰ ET PROTECTION
---------------------------
âœ… F6.1 - Protection du contenu
  - Lecteur PDF custom (pas de PDF natif navigateur)
  - DÃ©sactivation JavaScript dans PDF
  - Blocage extensions navigateur (tentative)
  - URL signÃ©es temporaires (expiration 1h)
  - Filigrane dynamique overlay:
      Format: "BibliothÃ¨que [Nom] - ConsultÃ© le [Date] - [IP]"
      Position: Diagonale ou bas de page
      OpacitÃ©: 30%
      Couleur: Gris clair

âœ… F6.2 - Rate limiting
  - Limitation requÃªtes API (100/min par IP)
  - Limitation lectures (10 documents/jour sans compte)
  - Protection anti-scraping
  - Captcha si comportement suspect

âœ… F6.3 - Protection anti-indexation abusive
  - Robots.txt configurÃ©
  - Meta noindex sur lecteur PDF
  - User-agent detection
  - Blocage bots connus (configurable)

âœ… F6.4 - IntÃ©gritÃ© des fichiers
  - VÃ©rification hash SHA-256 Ã  l'upload
  - Scan antivirus (ClamAV recommandÃ©)
  - Validation stricte format PDF
  - Rejet des PDF corrompus ou malformÃ©s

âœ… F6.5 - SÃ©curitÃ© backend
  - HTTPS obligatoire (TLS 1.3)
  - CORS configurÃ©
  - CSRF protection
  - SQL injection prevention (ORM)
  - XSS protection
  - Headers de sÃ©curitÃ© (Helmet.js)

3.7 RÃ”LES ET PERMISSIONS
-------------------------
ğŸ‘¤ VISITEUR PUBLIC (non authentifiÃ©)
  Permissions:
    âœ… Consulter le catalogue
    âœ… Rechercher
    âœ… Lire les documents validÃ©s
    âœ… Voir les mÃ©tadonnÃ©es publiques
    âŒ DÃ©poser des documents
    âŒ TÃ©lÃ©charger
    âŒ Imprimer
    âŒ AccÃ©der au backoffice

ğŸ‘¨â€ğŸ’¼ ADMINISTRATEUR
  Permissions:
    âœ… Toutes les permissions visiteur
    âœ… AccÃ©der au dashboard admin
    âœ… DÃ©poser des documents
    âœ… Ã‰diter les mÃ©tadonnÃ©es
    âœ… Valider/Rejeter les documents
    âœ… Supprimer des documents
    âœ… Voir les statistiques complÃ¨tes
    âœ… GÃ©rer les utilisateurs admin
    âœ… Exporter les donnÃ©es
    âœ… Configurer la plateforme

ğŸ‘¨â€ğŸ’¼ SUPER ADMINISTRATEUR (optionnel)
  Permissions:
    âœ… Toutes les permissions admin
    âœ… GÃ©rer les rÃ´les
    âœ… AccÃ©der aux logs systÃ¨me
    âœ… Configurer la sÃ©curitÃ©
    âœ… GÃ©rer les backups
    âœ… AccÃ©der Ã  la base de donnÃ©es

3.8 STATISTIQUES ET ANALYTICS
------------------------------
âœ… F8.1 - Dashboard administrateur
  MÃ©triques affichÃ©es:
    - Nombre total de documents
    - Nombre de documents par statut
    - Nombre de vues aujourd'hui/semaine/mois
    - Top 10 documents consultÃ©s
    - Top 10 recherches
    - Nombre de visiteurs uniques
    - Graphiques de tendances
    - Documents rÃ©cemment ajoutÃ©s
    - Documents en attente de validation

âœ… F8.2 - Analytics par document
  Pour chaque document:
    - Nombre de vues total
    - Vues par pÃ©riode (jour/semaine/mois)
    - DurÃ©e moyenne de consultation
    - Provenance des visiteurs (pays/ville)
    - Recherches ayant menÃ© au document

âœ… F8.3 - Rapports exportables
  Formats:
    - PDF
    - Excel (XLSX)
    - CSV
    - JSON

  Types de rapports:
    - Rapport mensuel global
    - Rapport par filiÃ¨re
    - Rapport par Ã©tablissement
    - Rapport par annÃ©e acadÃ©mique

âœ… F8.4 - Respect de la vie privÃ©e
  - Anonymisation des IPs
  - Pas de cookies tiers
  - ConformitÃ© RGPD
  - Politique de confidentialitÃ© claire
  - BanniÃ¨re de consentement cookies

================================================================================
4. MODÃˆLE DE BASE DE DONNÃ‰ES (PostgreSQL)
================================================================================

4.1 SCHÃ‰MA CONCEPTUEL
---------------------

EntitÃ©s principales:
  - users (administrateurs)
  - documents
  - authors
  - supervisors
  - institutions
  - faculties
  - fields (filiÃ¨res)
  - cycles
  - keywords
  - document_views (statistiques)
  - search_queries (historique recherches)

4.2 TABLES DÃ‰TAILLÃ‰ES
----------------------

TABLE: users (Administrateurs)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Colonne              â”‚ Type         â”‚ Contraintes                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY, DEFAULT uuid  â”‚
â”‚ email                â”‚ VARCHAR(255) â”‚ UNIQUE, NOT NULL           â”‚
â”‚ password_hash        â”‚ VARCHAR(255) â”‚ NOT NULL                   â”‚
â”‚ first_name           â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ last_name            â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ role                 â”‚ ENUM         â”‚ admin, super_admin         â”‚
â”‚ is_active            â”‚ BOOLEAN      â”‚ DEFAULT true               â”‚
â”‚ last_login           â”‚ TIMESTAMP    â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â”‚ updated_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TABLE: institutions (Ã‰tablissements)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ name                 â”‚ VARCHAR(255) â”‚ UNIQUE, NOT NULL           â”‚
â”‚ acronym              â”‚ VARCHAR(20)  â”‚                            â”‚
â”‚ country              â”‚ VARCHAR(100) â”‚ DEFAULT 'France'           â”‚
â”‚ city                 â”‚ VARCHAR(100) â”‚                            â”‚
â”‚ website              â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ logo_url             â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TABLE: faculties (FacultÃ©s/Instituts)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ institution_id       â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ name                 â”‚ VARCHAR(255) â”‚ NOT NULL                   â”‚
â”‚ acronym              â”‚ VARCHAR(20)  â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_faculties_institution ON faculties(institution_id)

TABLE: fields (FiliÃ¨res)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ faculty_id           â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ name                 â”‚ VARCHAR(255) â”‚ NOT NULL                   â”‚
â”‚ slug                 â”‚ VARCHAR(255) â”‚ UNIQUE                     â”‚
â”‚ description          â”‚ TEXT         â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_fields_faculty ON fields(faculty_id)

TABLE: cycles
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ name                 â”‚ VARCHAR(100) â”‚ UNIQUE, NOT NULL           â”‚
â”‚ level                â”‚ INTEGER      â”‚ (1=License, 2=Master, etc.)â”‚
â”‚ slug                 â”‚ VARCHAR(100) â”‚ UNIQUE                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Valeurs typiques: Licence, Master, Doctorat, BTS, DUT, IngÃ©nieur

TABLE: authors (Auteurs)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ first_name           â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ last_name            â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ email                â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ photo_url            â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_authors_name ON authors(last_name, first_name)

TABLE: supervisors (Encadreurs)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ first_name           â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ last_name            â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ email                â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ title                â”‚ VARCHAR(100) â”‚ (Professeur, Dr, etc.)     â”‚
â”‚ institution_id       â”‚ UUID         â”‚ FOREIGN KEY                â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_supervisors_name ON supervisors(last_name, first_name)

TABLE: documents (Documents acadÃ©miques)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ title                â”‚ VARCHAR(500) â”‚ NOT NULL                   â”‚
â”‚ slug                 â”‚ VARCHAR(500) â”‚ UNIQUE                     â”‚
â”‚ abstract             â”‚ TEXT         â”‚ NOT NULL                   â”‚
â”‚ language             â”‚ VARCHAR(5)   â”‚ DEFAULT 'fr'               â”‚
â”‚ page_count           â”‚ INTEGER      â”‚                            â”‚
â”‚ document_type        â”‚ ENUM         â”‚ memoir, thesis, internship â”‚
â”‚ academic_year        â”‚ VARCHAR(20)  â”‚ NOT NULL (ex: 2023-2024)   â”‚
â”‚ defense_date         â”‚ DATE         â”‚ NOT NULL                   â”‚
â”‚ author_id            â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ institution_id       â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ faculty_id           â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ field_id             â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ cycle_id             â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ main_supervisor_id   â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ co_supervisor_id     â”‚ UUID         â”‚ FOREIGN KEY (nullable)     â”‚
â”‚ file_name            â”‚ VARCHAR(255) â”‚ NOT NULL                   â”‚
â”‚ file_size            â”‚ BIGINT       â”‚ NOT NULL (bytes)           â”‚
â”‚ file_hash            â”‚ VARCHAR(64)  â”‚ NOT NULL (SHA-256)         â”‚
â”‚ s3_key               â”‚ VARCHAR(500) â”‚ NOT NULL                   â”‚
â”‚ s3_bucket            â”‚ VARCHAR(100) â”‚ NOT NULL                   â”‚
â”‚ status               â”‚ ENUM         â”‚ draft, pending, approved,  â”‚
â”‚                      â”‚              â”‚ rejected, archived         â”‚
â”‚ is_confidential      â”‚ BOOLEAN      â”‚ DEFAULT false              â”‚
â”‚ embargo_until        â”‚ DATE         â”‚ (nullable)                 â”‚
â”‚ rejection_reason     â”‚ TEXT         â”‚ (nullable)                 â”‚
â”‚ view_count           â”‚ INTEGER      â”‚ DEFAULT 0                  â”‚
â”‚ popularity_score     â”‚ FLOAT        â”‚ DEFAULT 0.0                â”‚
â”‚ uploaded_by          â”‚ UUID         â”‚ FOREIGN KEY (users)        â”‚
â”‚ approved_by          â”‚ UUID         â”‚ FOREIGN KEY (users)        â”‚
â”‚ approved_at          â”‚ TIMESTAMP    â”‚                            â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â”‚ updated_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â”‚ last_viewed_at       â”‚ TIMESTAMP    â”‚                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

INDEXES sur documents:
  - idx_documents_status ON documents(status)
  - idx_documents_author ON documents(author_id)
  - idx_documents_field ON documents(field_id)
  - idx_documents_cycle ON documents(cycle_id)
  - idx_documents_year ON documents(academic_year)
  - idx_documents_created ON documents(created_at DESC)
  - idx_documents_views ON documents(view_count DESC)
  - idx_documents_fulltext ON documents USING GIN(to_tsvector('french', title || ' ' || abstract))

TABLE: keywords (Mots-clÃ©s)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ keyword              â”‚ VARCHAR(100) â”‚ UNIQUE, NOT NULL           â”‚
â”‚ slug                 â”‚ VARCHAR(100) â”‚ UNIQUE                     â”‚
â”‚ usage_count          â”‚ INTEGER      â”‚ DEFAULT 0                  â”‚
â”‚ created_at           â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_keywords_usage ON keywords(usage_count DESC)

TABLE: document_keywords (Table de liaison Many-to-Many)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ document_id          â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ keyword_id           â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
PRIMARY KEY: (document_id, keyword_id)
INDEXES:
  - idx_doc_keywords_doc ON document_keywords(document_id)
  - idx_doc_keywords_kw ON document_keywords(keyword_id)

TABLE: document_views (Statistiques de consultation)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ document_id          â”‚ UUID         â”‚ FOREIGN KEY, NOT NULL      â”‚
â”‚ viewer_ip            â”‚ INET         â”‚ (anonymisÃ© aprÃ¨s 30j)      â”‚
â”‚ viewer_country       â”‚ VARCHAR(50)  â”‚                            â”‚
â”‚ viewer_city          â”‚ VARCHAR(100) â”‚                            â”‚
â”‚ user_agent           â”‚ TEXT         â”‚                            â”‚
â”‚ referrer             â”‚ VARCHAR(255) â”‚                            â”‚
â”‚ session_duration     â”‚ INTEGER      â”‚ (secondes)                 â”‚
â”‚ viewed_at            â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEXES:
  - idx_views_document ON document_views(document_id)
  - idx_views_date ON document_views(viewed_at DESC)
  
PARTITION BY: viewed_at (par mois) pour performance

TABLE: search_queries (Historique de recherche)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id                   â”‚ UUID         â”‚ PRIMARY KEY                â”‚
â”‚ query                â”‚ VARCHAR(500) â”‚ NOT NULL                   â”‚
â”‚ filters              â”‚ JSONB        â”‚ (filtres appliquÃ©s)        â”‚
â”‚ results_count        â”‚ INTEGER      â”‚                            â”‚
â”‚ clicked_document_id  â”‚ UUID         â”‚ FOREIGN KEY (nullable)     â”‚
â”‚ searcher_ip          â”‚ INET         â”‚ (anonymisÃ© aprÃ¨s 30j)      â”‚
â”‚ searched_at          â”‚ TIMESTAMP    â”‚ DEFAULT NOW()              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
INDEX: idx_search_query ON search_queries(query)

4.3 RELATIONS
-------------

authors â†â”€â”€â”€â”€ documents (1:N)
  Un auteur peut avoir plusieurs documents

supervisors â†â”€â”€â”€â”€ documents (1:N) 
  Un encadreur peut superviser plusieurs documents

institutions â†â”€â”€â”€â”€ faculties (1:N)
  Une institution a plusieurs facultÃ©s

faculties â†â”€â”€â”€â”€ fields (1:N)
  Une facultÃ© a plusieurs filiÃ¨res

documents â†â”€â”€â†’ keywords (N:N via document_keywords)
  Un document a plusieurs mots-clÃ©s
  Un mot-clÃ© peut Ãªtre dans plusieurs documents

users (uploadÃ©_by) â†â”€â”€â”€â”€ documents (1:N)
  Un admin peut uploader plusieurs documents

users (approved_by) â†â”€â”€â”€â”€ documents (1:N)
  Un admin peut approuver plusieurs documents

documents â†â”€â”€â”€â”€ document_views (1:N)
  Un document peut avoir plusieurs vues

4.4 RÃˆGLES DE GESTION
----------------------

RG1: Un document ne peut Ãªtre visible publiquement que si status = 'approved'
RG2: Un document confidentiel ne peut Ãªtre consultÃ© qu'aprÃ¨s embargo_until
RG3: file_hash doit Ãªtre unique pour Ã©viter les doublons
RG4: view_count s'incrÃ©mente Ã  chaque consultation unique (1 vue/IP/jour)
RG5: popularity_score calculÃ© avec: (view_count * 0.7) + (age_factor * 0.3)
RG6: Les IPs dans document_views sont anonymisÃ©es aprÃ¨s 30 jours (RGPD)
RG7: search_queries conservÃ©es 90 jours puis supprimÃ©es
RG8: Soft delete sur documents (status = 'archived') par dÃ©faut
RG9: Hard delete uniquement par super_admin avec confirmation

================================================================================
5. SÃ‰CURITÃ‰ ET PROTECTION DU CONTENU
================================================================================

5.1 STRATÃ‰GIE DE PROTECTION PDF
--------------------------------

Niveau 1: Protection cÃ´tÃ© client (Frontend)
  âœ… Utilisation de PDF.js custom
  âœ… Canvas rendering (pas de <iframe> natif)
  âœ… DÃ©sactivation du menu contextuel (clic droit)
  âœ… DÃ©sactivation des raccourcis clavier (Ctrl+P, Ctrl+S)
  âœ… DÃ©sactivation de la sÃ©lection de texte (user-select: none)
  âœ… Overlay transparent sur le canvas pour bloquer interactions
  âœ… DÃ©tection des DevTools (tentative)
  âœ… Filigrane dynamique en overlay CSS

Niveau 2: Protection cÃ´tÃ© serveur (Backend)
  âœ… URL signÃ©es temporaires (JWT expiration 1h)
  âœ… Validation du token Ã  chaque requÃªte
  âœ… Rate limiting par IP (max 10 docs/heure)
  âœ… Logging de toutes les consultations
  âœ… Blocage des bots connus (User-Agent)
  âœ… CORS restrictif

Niveau 3: Protection du stockage (S3)
  âœ… Bucket privÃ© (Block Public Access activÃ©)
  âœ… Pas d'accÃ¨s direct aux fichiers
  âœ… GÃ©nÃ©ration de presigned URLs cÃ´tÃ© backend uniquement
  âœ… Encryption at rest (AES-256)
  âœ… Encryption in transit (TLS 1.3)
  âœ… Versioning activÃ©
  âœ… Lifecycle policies (archivage Glacier aprÃ¨s 1 an)

Niveau 4: Filigrane (Watermark)
  âœ… Ajout automatique lors de l'upload (Python/ReportLab)
  âœ… Filigrane embarquÃ© dans le PDF
  âœ… Filigrane overlay dynamique lors de la lecture
  âœ… Contenu du filigrane:
      - Nom de la bibliothÃ¨que
      - Date et heure de consultation
      - IP du visiteur (partielle, ex: 192.168.x.x)
      - Message: "Document protÃ©gÃ© - Consultation en ligne uniquement"

5.2 LIMITATION DES RISQUES
---------------------------

Risque: Capture d'Ã©cran
  Mitigation: 
    - Impossible Ã  bloquer techniquement
    - Filigrane visible dissuade le partage
    - QualitÃ© dÃ©gradÃ©e vs PDF original

Risque: Impression d'Ã©cran
  Mitigation:
    - DÃ©sactivation Ctrl+P
    - CSS @media print { display: none; }
    - Message d'avertissement si impression dÃ©tectÃ©e

Risque: Extraction via DevTools
  Mitigation:
    - DÃ©tection d'ouverture des DevTools
    - DÃ©sactivation temporaire si DevTools ouvert
    - Alertes admin en cas d'abus

Risque: TÃ©lÃ©chargement via scripts/bots
  Mitigation:
    - Rate limiting agressif
    - Captcha aprÃ¨s X tentatives
    - Blocage permanent si abus dÃ©tectÃ©
    - Honeypots (fausses URLs)

Risque: OCR sur captures d'Ã©cran
  Mitigation:
    - Impossible Ã  bloquer
    - AcceptÃ© comme risque rÃ©siduel minimal

5.3 AUTHENTIFICATION ET AUTORISATION
-------------------------------------

Pour les administrateurs uniquement:

MÃ©thode: JWT (JSON Web Tokens)
  Access Token:
    - DurÃ©e de vie: 15 minutes
    - Stockage: Memory (variable JS)
    - Contenu: user_id, role, email
  
  Refresh Token:
    - DurÃ©e de vie: 7 jours
    - Stockage: HttpOnly Cookie (secure)
    - Rotation automatique

Workflow de login:
  1. User envoie email + password
  2. Backend vÃ©rifie credentials (bcrypt)
  3. Backend gÃ©nÃ¨re access + refresh tokens
  4. Frontend stocke access token en mÃ©moire
  5. Refresh token en cookie HttpOnly

Workflow de refresh:
  1. Access token expirÃ©
  2. Frontend envoie refresh token automatiquement
  3. Backend valide refresh token
  4. Backend gÃ©nÃ¨re nouveau access token
  5. Si refresh token expirÃ© â†’ logout

Protection:
  - HTTPS obligatoire
  - Bcrypt avec salt (cost factor 12)
  - Rate limiting sur /login (5 tentatives/5min)
  - Account lockout aprÃ¨s 10 Ã©checs
  - 2FA optionnel (TOTP)

5.4 PROTECTION CONTRE LES ATTAQUES
-----------------------------------

SQL Injection:
  âœ… Utilisation ORM (Prisma) exclusivement
  âœ… RequÃªtes paramÃ©trÃ©es
  âœ… Validation stricte des entrÃ©es

XSS (Cross-Site Scripting):
  âœ… Sanitization de toutes les entrÃ©es utilisateur
  âœ… Content Security Policy (CSP) stricte
  âœ… Ã‰chappement automatique (React)
  âœ… DOMPurify pour les contenus riches

CSRF (Cross-Site Request Forgery):
  âœ… Tokens CSRF sur toutes les mutations
  âœ… SameSite cookies
  âœ… VÃ©rification de l'origin

DDoS:
  âœ… Rate limiting global (Nginx/CloudFlare)
  âœ… Rate limiting par endpoint
  âœ… CloudFlare protection (optionnel)
  âœ… Auto-scaling infrastructure

Upload malveillants:
  âœ… Validation stricte format PDF
  âœ… Scan antivirus (ClamAV)
  âœ… Taille max 50MB
  âœ… VÃ©rification Magic Numbers
  âœ… Sandbox d'upload temporaire

SSRF (Server-Side Request Forgery):
  âœ… Pas de fetch d'URLs externes depuis le backend
  âœ… Whitelist stricte si nÃ©cessaire

5.5 CONFORMITÃ‰ RGPD
--------------------

DonnÃ©es personnelles collectÃ©es:
  - Administrateurs: email, nom, prÃ©nom
  - Auteurs: nom, prÃ©nom, email (optionnel)
  - Visiteurs: IP (anonymisÃ©e aprÃ¨s 30j), pays, ville

Mesures de conformitÃ©:
  âœ… BanniÃ¨re de consentement cookies
  âœ… Politique de confidentialitÃ©
  âœ… Mentions lÃ©gales
  âœ… Droit d'accÃ¨s (pour auteurs)
  âœ… Droit de rectification
  âœ… Droit Ã  l'effacement (RGPD)
  âœ… Anonymisation automatique des IPs
  âœ… Registre des traitements
  âœ… DPO dÃ©signÃ© (si >250 employÃ©s)
  âœ… Chiffrement des donnÃ©es sensibles
  âœ… Audits de sÃ©curitÃ© rÃ©guliers

================================================================================
6. INTERFACE UTILISATEUR (UX/UI)
================================================================================

6.1 PRINCIPES DE DESIGN
------------------------

Design System: Material Design 3 ou custom
  Justification:
    - Accessible (WCAG 2.1 AA minimum)
    - Responsive
    - CohÃ©rent
    - Moderne

Charte graphique:
  - Couleurs: Tons acadÃ©miques (bleu marine, gris, blanc)
  - Typographie: 
      Titres: Inter, Roboto, ou Poppins
      Texte: Open Sans, Lato, ou system fonts
  - Espacements: Ã‰chelle 8px
  - Coins arrondis: 8px (composants), 16px (cartes)

AccessibilitÃ©:
  âœ… Contraste minimum 4.5:1 (texte)
  âœ… Navigation au clavier complÃ¨te
  âœ… Screen reader friendly (ARIA labels)
  âœ… Focus visible
  âœ… Tailles de texte ajustables
  âœ… Pas de contenu clignotant

6.2 PAGES PRINCIPALES
----------------------

Page: Accueil (/)
  Sections:
    - Hero: Barre de recherche + slogan
    - Statistiques: Nombre de docs, filiÃ¨res, Ã©tablissements
    - Documents rÃ©cents (carrousel)
    - Documents populaires (grille 3 colonnes)
    - Parcourir par cycle (cartes cliquables)
    - Footer: Liens utiles, contact, mentions lÃ©gales

Page: Recherche (/search)
  Layout:
    - Sidebar gauche: Filtres
    - Corps principal: RÃ©sultats + tri
    - Barre de recherche sticky en haut

  Composants:
    - Breadcrumbs
    - Nombre de rÃ©sultats
    - Filtres actifs (pills supprimables)
    - Carte de rÃ©sultat:
        * Miniature premiÃ¨re page (optionnel)
        * Titre (surlignÃ© si recherche)
        * Auteur + annÃ©e
        * Extrait rÃ©sumÃ© (150 caractÃ¨res)
        * Badges: cycle, filiÃ¨re
        * IcÃ´ne vues
        * Bouton "Lire"
    - Pagination ou scroll infini

Page: DÃ©tail document (/document/[slug])
  Sections:
    - Header: Titre + mÃ©tadonnÃ©es principales
    - Sidebar droite: Informations complÃ©mentaires
        * Auteur (avec photo si dispo)
        * Encadreur
        * Ã‰tablissement
        * FiliÃ¨re
        * Date de soutenance
        * Nombre de pages
        * Vues
        * Mots-clÃ©s (tags cliquables)
    - Corps:
        * RÃ©sumÃ© complet
        * Bouton "Lire en ligne" (CTA principal)
        * Section "Documents similaires"
        * Bouton "Signaler"

Page: Lecteur PDF (/reader/[id])
  Layout fullscreen:
    - Header minimal:
        * Logo + titre document
        * Zoom controls
        * Page X/Y
        * Bouton fermer
    - Corps: Canvas PDF.js
    - Sidebar gauche (toggleable):
        * Miniatures pages
        * Table des matiÃ¨res (si prÃ©sente)
    - Footer: Filigrane visible

Page: Parcourir par cycle (/browse/cycle/[slug])
  Layout:
    - Breadcrumbs
    - Titre + description du cycle
    - Statistiques (nombre de docs, filiÃ¨res)
    - Liste filtrÃ©e de documents
    - Filtres toujours disponibles

Dashboard Admin (/admin)
  Sections:
    - Vue d'ensemble (statistiques)
    - Documents en attente (liste + actions rapides)
    - Documents rÃ©cents
    - Graphiques (vues, uploads)
    - AccÃ¨s rapides:
        * DÃ©poser un document
        * GÃ©rer les utilisateurs
        * Voir les statistiques complÃ¨tes

Page: DÃ©pÃ´t de document (/admin/upload)
  Formulaire multi-Ã©tapes:
    Ã‰tape 1: Upload du fichier
      - Drag & drop zone
      - Validation format/taille
      - Preview PDF

    Ã‰tape 2: Informations auteur
      - Recherche auteur existant ou crÃ©ation
      - Nom, prÃ©nom, email, photo

    Ã‰tape 3: Informations acadÃ©miques
      - Ã‰tablissement (select)
      - FacultÃ© (select dÃ©pendant)
      - FiliÃ¨re (select dÃ©pendant)
      - Cycle (select)
      - AnnÃ©e acadÃ©mique
      - Date de soutenance

    Ã‰tape 4: Encadrement
      - Recherche encadreur ou crÃ©ation
      - Co-encadreur (optionnel)

    Ã‰tape 5: Contenu
      - Titre (prÃ©-rempli si extrait PDF)
      - RÃ©sumÃ© (textarea)
      - Mots-clÃ©s (tags input, min 3)
      - Langue (select)

    Ã‰tape 6: Validation
      - RÃ©capitulatif
      - Bouton "Soumettre pour validation"
      - Bouton "Enregistrer comme brouillon"

6.3 COMPOSANTS RÃ‰UTILISABLES
-----------------------------

SearchBar:
  Props: placeholder, onSearch, autoComplete
  Features: Suggestions, historique rÃ©cent, clear button

DocumentCard:
  Props: document object
  Variants: liste, grille, compact

FilterPanel:
  Props: filters config, onFilterChange
  Features: Collapse/expand, badges actifs, reset

PDFViewer:
  Props: documentId, watermark config
  Features: Zoom, navigation, fullscreen, watermark overlay

StatsCard:
  Props: title, value, icon, trend
  Variants: simple, avec graphique

Table:
  Props: data, columns, actions
  Features: Tri, pagination, sÃ©lection multiple, export

Modal:
  Props: title, content, actions
  Variants: confirmation, formulaire, fullscreen

Toast/Notification:
  Types: success, error, warning, info
  Position: top-right par dÃ©faut

Breadcrumbs:
  Props: items array
  Features: Auto-gÃ©nÃ©ration depuis route

Pagination:
  Props: totalItems, itemsPerPage, currentPage
  Variants: numbers, prev/next, load more

TagInput:
  Props: tags, onTagsChange, suggestions
  Features: Auto-complete, crÃ©ation rapide

6.4 RESPONSIVE DESIGN
----------------------

Breakpoints:
  - Mobile: < 640px
  - Tablet: 640px - 1024px
  - Desktop: > 1024px

Adaptations Mobile:
  âœ… Navigation hamburger
  âœ… Filtres en modal/drawer
  âœ… Cartes en colonne simple
  âœ… Formulaires simplifiÃ©s
  âœ… Touch-friendly (min 44px touch targets)
  âœ… Swipe gestures (lecteur PDF)

Optimisations:
  âœ… Images responsive (srcset)
  âœ… Lazy loading
  âœ… Code splitting (Next.js automatique)
  âœ… Service Worker (PWA)
  âœ… Offline fallback

6.5 DARK MODE
--------------

ImplÃ©mentation:
  âœ… Toggle dans header
  âœ… PrÃ©fÃ©rence sauvegardÃ©e (localStorage)
  âœ… Respect system preference (prefers-color-scheme)
  âœ… Transition smooth

Palette Dark:
  - Background: #1a1a1a
  - Surface: #2d2d2d
  - Text primary: #ffffff
  - Text secondary: #b0b0b0
  - Accent: MÃªme couleur primaire, ajustÃ©e

================================================================================
7. INTÃ‰GRATION MEILISEARCH
================================================================================

7.1 CONFIGURATION
-----------------

Index principal: documents

Champs indexÃ©s (searchableAttributes):
  - title (poids: 5)
  - abstract (poids: 3)
  - keywords (poids: 4)
  - author_name (poids: 2)
  - supervisor_name (poids: 1)

Champs filtrables (filterableAttributes):
  - cycle_id
  - field_id
  - institution_id
  - faculty_id
  - academic_year
  - defense_date
  - language
  - document_type

Champs triables (sortableAttributes):
  - defense_date
  - created_at
  - view_count
  - popularity_score

Champs affichÃ©s (displayedAttributes):
  - id
  - title
  - slug
  - abstract
  - author_name
  - cycle_name
  - field_name
  - academic_year
  - defense_date
  - view_count

7.2 STRATÃ‰GIE D'INDEXATION
---------------------------

Indexation initiale:
  - Script de migration pour peupler Meilisearch
  - Batch processing (1000 docs/batch)
  - Progress bar et logs

Indexation incrÃ©mentale:
  Triggers:
    - Nouveau document approuvÃ© â†’ addDocuments()
    - Document modifiÃ© â†’ updateDocuments()
    - Document supprimÃ© â†’ deleteDocuments()

  ImplÃ©mentation:
    - Webhooks depuis NestJS
    - Queue Celery/Bull pour async
    - Retry automatique si Ã©chec

RÃ©indexation complÃ¨te:
  - Commande admin manuelle
  - PlanifiÃ©: 1 fois/semaine (nuit)
  - UtilisÃ© en cas de drift donnÃ©es

7.3 REQUÃŠTES DE RECHERCHE
--------------------------

Recherche simple:
```javascript
const results = await meili.index('documents').search(query, {
  limit: 20,
  offset: 0,
  attributesToHighlight: ['title', 'abstract'],
  attributesToCrop: ['abstract'],
  cropLength: 200
});
```

Recherche avec filtres:
```javascript
const results = await meili.index('documents').search(query, {
  filter: [
    'cycle_id = "uuid-master"',
    'academic_year >= "2020-2021"',
    'field_id IN ["uuid-1", "uuid-2"]'
  ],
  sort: ['view_count:desc'],
  limit: 20
});
```

Facettes (pour filtres UI):
```javascript
const results = await meili.index('documents').search(query, {
  facets: ['cycle_id', 'field_id', 'academic_year', 'language']
});

// Retourne le nombre de documents par facette
// Ex: { cycle_id: { "uuid-licence": 120, "uuid-master": 85 } }
```

7.4 OPTIMISATIONS
-----------------

Typo Tolerance:
  - 1 typo autorisÃ©e pour mots < 5 caractÃ¨res
  - 2 typos autorisÃ©es pour mots >= 5 caractÃ¨res

Stop Words (franÃ§ais):
  - le, la, les, de, du, des, un, une, etc.
  - Liste complÃ¨te configurable

Synonymes:
  - IA â†” Intelligence Artificielle
  - ML â†” Machine Learning
  - Dev â†” DÃ©veloppement
  - Config personnalisable

Proximity Ranking:
  - Termes proches dans le texte = meilleur score

================================================================================
8. STOCKAGE AWS S3
================================================================================

8.1 CONFIGURATION S3
--------------------

Bucket: academic-library-prod
  RÃ©gion: eu-west-1 (ou la plus proche)
  
  ParamÃ¨tres:
    âœ… Block Public Access: ActivÃ©
    âœ… Versioning: ActivÃ©
    âœ… Encryption: AES-256 (SSE-S3)
    âœ… Logging: ActivÃ© (vers bucket de logs)
    âœ… Object Lock: Optionnel (immutabilitÃ©)

  Structure des dossiers:
    /documents/
      /{year}/
        /{cycle}/
          /{institution}/
            /{document_id}.pdf

  Exemple:
    /documents/2024/master/universite-paris/abc123-xyz789.pdf

Lifecycle Policies:
  - Standard â†’ Infrequent Access (aprÃ¨s 90 jours sans accÃ¨s)
  - Infrequent Access â†’ Glacier (aprÃ¨s 1 an)
  - Suppression dÃ©finitive (aprÃ¨s 7 ans - configurable)

8.2 UPLOAD WORKFLOW
-------------------

CÃ´tÃ© Frontend (Next.js):
  1. User sÃ©lectionne fichier PDF
  2. Validation cÃ´tÃ© client (taille, format)
  3. Demande de presigned POST URL au backend
  4. Upload direct vers S3 avec presigned URL
  5. Callback vers backend avec s3_key
  6. Backend finalise l'enregistrement DB

CÃ´tÃ© Backend (NestJS):
  1. GÃ©nÃ©ration presigned POST URL (expiration 1h)
  2. Retour URL au frontend
  3. RÃ©ception callback post-upload
  4. VÃ©rification fichier existe sur S3
  5. Traitement asynchrone:
      - Extraction mÃ©tadonnÃ©es
      - Ajout filigrane
      - Scan antivirus
      - GÃ©nÃ©ration miniature
      - Indexation Meilisearch
  6. Mise Ã  jour statut document DB

8.3 DOWNLOAD WORKFLOW (Lecture)
--------------------------------

CÃ´tÃ© Frontend:
  1. User clique "Lire en ligne"
  2. Demande URL signÃ©e au backend
  3. RÃ©ception URL signÃ©e (expiration 1h)
  4. Chargement PDF via PDF.js
  5. Rendering dans canvas sÃ©curisÃ©
  6. IncrÃ©mentation view_count

CÃ´tÃ© Backend:
  1. VÃ©rification permissions (document approved)
  2. Rate limiting (10 docs/heure par IP)
  3. GÃ©nÃ©ration presigned GET URL S3
  4. Logging de la consultation
  5. Retour URL au frontend

Presigned URL:
```javascript
const url = s3.getSignedUrl('getObject', {
  Bucket: 'academic-library-prod',
  Key: document.s3_key,
  Expires: 3600, // 1 heure
  ResponseContentDisposition: 'inline', // Forcer affichage
  ResponseContentType: 'application/pdf'
});
```

8.4 SÃ‰CURITÃ‰ S3
---------------

IAM Policy (Backend):
  Permissions minimales:
    - s3:PutObject (sur /documents/*)
    - s3:GetObject (sur /documents/*)
    - s3:DeleteObject (sur /documents/*)
    - s3:ListBucket

Bucket Policy:
  - Deny all public access
  - Allow uniquement via IAM roles
  - Enforce HTTPS (aws:SecureTransport)
  - Deny unencrypted uploads

CORS Configuration:
```json
{
  "CORSRules": [{
    "AllowedOrigins": ["https://yourdomain.com"],
    "AllowedMethods": ["GET", "PUT", "POST"],
    "AllowedHeaders": ["*"],
    "ExposeHeaders": ["ETag"],
    "MaxAgeSeconds": 3600
  }]
}
```

8.5 MONITORING S3
------------------

MÃ©triques CloudWatch:
  - Nombre de requÃªtes (GET/PUT)
  - Taille totale du bucket
  - Erreurs 4xx/5xx
  - Latence moyenne

Alertes:
  - Alerte si erreurs > 5% des requÃªtes
  - Alerte si latence > 2 secondes
  - Alerte si coÃ»ts > seuil dÃ©fini

Logs:
  - Access logs vers bucket sÃ©parÃ©
  - Analyse avec AWS Athena
  - DÃ©tection d'anomalies

8.6 OPTIMISATION COÃ›TS
----------------------

CloudFront CDN:
  - Distribution pour /documents/*
  - Cache TTL 1 heure
  - Invalidation automatique si document modifiÃ©
  - RÃ©duction coÃ»ts S3 GET

Intelligent Tiering:
  - DÃ©placement automatique vers IA si peu consultÃ©
  - Ã‰conomies 40% sur objets rarement accÃ©dÃ©s

Requester Pays (optionnel):
  - TransfÃ©rer coÃ»ts de bande passante au demandeur
  - Utile si trÃ¨s forte consultation externe

Estimation coÃ»ts mensuels (10,000 documents, 50GB):
  - Stockage S3: ~$1.15/mois
  - RequÃªtes GET (100k/mois): ~$0.04
  - Transfert sortant (50GB): ~$4.50
  - CloudFront: ~$3
  - Total: ~$9/mois

================================================================================
9. FONCTIONNALITÃ‰S AVANCÃ‰ES (ROADMAP)
================================================================================

9.1 PHASE 1 - MVP (Mois 1-3)
----------------------------
âœ… Consultation publique sans authentification
âœ… Lecteur PDF sÃ©curisÃ© avec filigrane
âœ… Recherche basique (titre, auteur, mots-clÃ©s)
âœ… Filtres essentiels (cycle, filiÃ¨re, annÃ©e)
âœ… Dashboard admin simple
âœ… Upload et validation de documents
âœ… MÃ©tadonnÃ©es complÃ¨tes
âœ… Stockage S3
âœ… Base de donnÃ©es PostgreSQL
âœ… Responsive design

9.2 PHASE 2 - AMÃ‰LIORATION (Mois 4-6)
--------------------------------------
â³ IntÃ©gration Meilisearch (recherche avancÃ©e)
â³ Statistiques dÃ©taillÃ©es (analytics)
â³ Dark mode
â³ Multilingue (FR/EN)
â³ PWA (Progressive Web App)
â³ Notifications admin (nouveaux dÃ©pÃ´ts)
â³ Export statistiques (PDF, Excel)
â³ Recommandations de documents similaires
â³ Historique de recherche (visiteurs)
â³ AmÃ©lioration UX/UI (animations, micro-interactions)

9.3 PHASE 3 - INNOVATION (Mois 7-12)
------------------------------------
ğŸ”® Application mobile (React Native)
ğŸ”® OCR automatique (extraction texte PDF scannÃ©s)
ğŸ”® DÃ©tection anti-plagiat
ğŸ”® Classification automatique (ML)
ğŸ”® RÃ©sumÃ©s automatiques (IA)
ğŸ”® Chatbot assistance recherche
ğŸ”® API publique (pour chercheurs)
ğŸ”® IntÃ©gration Zotero/Mendeley
ğŸ”® Citation automatique (APA, MLA, etc.)
ğŸ”® Social features (likes, commentaires modÃ©rÃ©s)
ğŸ”® Bookmark/Favoris (avec compte optionnel)
ğŸ”® Notifications nouveaux docs par filiÃ¨re

9.4 DÃ‰TAILS FONCTIONNALITÃ‰S AVANCÃ‰ES
-------------------------------------

OCR (Optical Character Recognition):
  Outil: Tesseract 5.0 + Python pytesseract
  Workflow:
    1. DÃ©tection si PDF scannÃ© (pas de couche texte)
    2. Conversion PDF â†’ Images (pdf2image)
    3. OCR par page
    4. Reconstruction PDF avec couche texte
    5. Remplacement PDF original
  
  Cas d'usage:
    - Vieux mÃ©moires scannÃ©s
    - Documents numÃ©risÃ©s sans OCR
    - AmÃ©lioration indexation recherche

Anti-Plagiat:
  MÃ©thode 1: Comparaison interne
    - Extraction texte de tous documents
    - Vectorisation (TF-IDF ou embeddings)
    - Calcul similaritÃ© cosinus
    - Alerte si similaritÃ© > 70%

  MÃ©thode 2: API externe (Copyleaks, Turnitin)
    - IntÃ©gration via API
    - CoÃ»t par document
    - Rapport dÃ©taillÃ©

  Workflow:
    1. Nouveau document uploadÃ©
    2. Extraction texte
    3. Comparaison avec corpus existant
    4. GÃ©nÃ©ration rapport similaritÃ©
    5. Notification admin si suspect
    6. Validation manuelle finale

Classification Automatique:
  ModÃ¨le: BERT multilingue fine-tunÃ©
  
  Training:
    - Dataset: Ensemble documents existants Ã©tiquetÃ©s
    - Features: titre + rÃ©sumÃ© + mots-clÃ©s
    - Labels: filiÃ¨res, cycles, domaines
    - Fine-tuning sur domaine acadÃ©mique
  
  Inference:
    1. Nouveau document uploadÃ©
    2. Extraction titre + rÃ©sumÃ©
    3. PrÃ©diction filiÃ¨re (top 3 suggestions)
    4. Admin valide ou corrige
    5. Feedback pour amÃ©liorer modÃ¨le
  
  BÃ©nÃ©fices:
    - Gain de temps admin
    - CohÃ©rence classification
    - Suggestions mots-clÃ©s

RÃ©sumÃ©s Automatiques (IA):
  ModÃ¨le: GPT-4, Claude, ou Llama fine-tunÃ©
  
  Workflow:
    1. Extraction texte intÃ©gral PDF
    2. Chunking (par sections si possible)
    3. GÃ©nÃ©ration rÃ©sumÃ© (250-500 mots)
    4. Extraction mots-clÃ©s automatique
    5. Admin review et Ã©dition
  
  Utilisation:
    - PrÃ©-remplissage rÃ©sumÃ© lors de l'upload
    - GÃ©nÃ©ration rÃ©sumÃ©s courts pour aperÃ§u
    - Traduction automatique rÃ©sumÃ©s

Chatbot Assistance:
  Technologie: RAG (Retrieval-Augmented Generation)
  
  Architecture:
    - Vectorisation corpus de documents
    - Stockage embeddings (Pinecone, Weaviate)
    - LLM (GPT-4, Claude) pour gÃ©nÃ©ration
    - Interface chat intÃ©grÃ©e
  
  FonctionnalitÃ©s:
    - "Trouve-moi des mÃ©moires sur l'IA en santÃ©"
    - "RÃ©sume-moi ce document"
    - "Quels sont les mots-clÃ©s tendance cette annÃ©e ?"
    - "Recommande-moi des documents similaires"
  
  Limites:
    - Pas d'accÃ¨s au contenu intÃ©gral (seulement mÃ©tadonnÃ©es)
    - RÃ©ponses basÃ©es sur rÃ©sumÃ©s et mots-clÃ©s
    - Redirection vers recherche classique pour prÃ©cision

API Publique:
  Endpoints:
    GET /api/v1/documents - Liste paginÃ©e
    GET /api/v1/documents/:id - DÃ©tails document
    GET /api/v1/search - Recherche
    GET /api/v1/stats - Statistiques publiques
  
  Authentification:
    - API Key (pour chercheurs enregistrÃ©s)
    - Rate limiting: 1000 req/jour gratuit
    - Plans payants pour usage intensif
  
  Documentation:
    - Swagger/OpenAPI
    - Exemples code (Python, JS, R)
    - SDKs officiels

Application Mobile (React Native):
  FonctionnalitÃ©s:
    - Recherche et consultation
    - Lecteur PDF optimisÃ© mobile
    - Notifications push (nouveaux docs)
    - Mode offline (cache)
    - Bookmarks synchronisÃ©s
    - Scanner QR (partage documents)
  
  Plateformes:
    - iOS 14+
    - Android 10+
  
  Tech Stack:
    - React Native (Expo)
    - React Navigation
    - React Query
    - AsyncStorage
    - PDF.js ou react-native-pdf

================================================================================
10. PLAN DE DÃ‰VELOPPEMENT
================================================================================

10.1 Ã‰QUIPE RECOMMANDÃ‰E
-----------------------

Pour un projet de cette envergure:

MVP (3 mois):
  - 1 Full-Stack Developer (Next.js + NestJS) - Senior
  - 1 DevOps Engineer (Docker, AWS, CI/CD) - Mid
  - 1 UI/UX Designer - Junior/Mid
  - 1 Chef de projet / Product Owner
  Total: 4 personnes

Production complÃ¨te (12 mois):
  - 2 Frontend Developers (Next.js, React Native)
  - 2 Backend Developers (NestJS)
  - 1 Data Engineer (ML/IA pour fonctionnalitÃ©s avancÃ©es)
  - 1 DevOps/SRE Engineer
  - 1 UI/UX Designer
  - 1 QA Engineer
  - 1 Product Owner
  - 1 Scrum Master (optionnel)
  Total: 9-10 personnes

10.2 TIMELINE DÃ‰TAILLÃ‰E
------------------------

SPRINT 0 (2 semaines) - Setup & Planification
  âœ… Setup repositories (Git, CI/CD)
  âœ… Configuration environnements (dev, staging, prod)
  âœ… Setup bases de donnÃ©es (PostgreSQL, Redis)
  âœ… Configuration AWS (S3, IAM)
  âœ… Design System & Wireframes
  âœ… Architecture technique validÃ©e
  âœ… User stories & backlog priorisÃ©

SPRINT 1-2 (4 semaines) - Fondations Backend
  âœ… Setup NestJS avec TypeScript
  âœ… Configuration Prisma ORM
  âœ… SchÃ©ma base de donnÃ©es complet
  âœ… Migrations initiales
  âœ… API CRUD documents
  âœ… API CRUD users/admin
  âœ… Authentification JWT
  âœ… IntÃ©gration AWS S3
  âœ… Upload de fichiers
  âœ… Tests unitaires (>70% coverage)

SPRINT 3-4 (4 semaines) - Frontend Core
  âœ… Setup Next.js 14 (App Router)
  âœ… Configuration Tailwind CSS
  âœ… Composants UI de base
  âœ… Pages publiques (accueil, recherche, dÃ©tail)
  âœ… IntÃ©gration API backend
  âœ… State management (Zustand)
  âœ… React Query pour data fetching
  âœ… Responsive design (mobile, tablet, desktop)

SPRINT 5 (2 semaines) - Lecteur PDF SÃ©curisÃ©
  âœ… IntÃ©gration PDF.js
  âœ… DÃ©sactivation tÃ©lÃ©chargement/impression
  âœ… Filigrane dynamique
  âœ… Navigation dans le PDF
  âœ… Mode plein Ã©cran
  âœ… Tests sÃ©curitÃ©

SPRINT 6 (2 semaines) - Dashboard Admin
  âœ… Pages admin (upload, validation, stats)
  âœ… Formulaire upload multi-Ã©tapes
  âœ… Workflow de validation
  âœ… Gestion utilisateurs
  âœ… Statistiques de base

SPRINT 7 (2 semaines) - Recherche & Filtres
  âœ… IntÃ©gration Meilisearch
  âœ… Indexation documents
  âœ… Recherche full-text
  âœ… Filtres multicritÃ¨res
  âœ… Tri des rÃ©sultats
  âœ… Pagination

SPRINT 8 (2 semaines) - SÃ©curitÃ© & Optimisation
  âœ… Rate limiting
  âœ… HTTPS & SSL
  âœ… Helmet.js (headers sÃ©curitÃ©)
  âœ… CORS configuration
  âœ… Sanitization inputs
  âœ… Audit de sÃ©curitÃ©
  âœ… Performance optimization
  âœ… Lighthouse score >90

SPRINT 9 (2 semaines) - Tests & QA
  âœ… Tests end-to-end (Cypress/Playwright)
  âœ… Tests d'intÃ©gration
  âœ… Tests de charge (K6)
  âœ… Tests de sÃ©curitÃ© (OWASP)
  âœ… Tests accessibilitÃ©
  âœ… Correction bugs

SPRINT 10 (2 semaines) - DÃ©ploiement & Documentation
  âœ… Configuration production (AWS)
  âœ… CI/CD finalisÃ©
  âœ… Monitoring (Sentry, Prometheus)
  âœ… Logging (Winston)
  âœ… Backups automatiques
  âœ… Documentation technique
  âœ… Documentation utilisateur
  âœ… Formation administrateurs

SPRINT 11-12 (4 semaines) - Buffer & AmÃ©liorations
  âœ… Correction bugs post-QA
  âœ… AmÃ©liorations UX basÃ©es sur feedback
  âœ… Optimisations performance
  âœ… PrÃ©paration lancement

TOTAL MVP: 24 semaines (6 mois)

10.3 BUDGET ESTIMATIF
---------------------

Infrastructure (mensuel):
  - AWS EC2 (t3.medium x2): $60
  - AWS RDS PostgreSQL (db.t3.medium): $70
  - AWS S3 (100GB + requÃªtes): $10
  - AWS CloudFront: $5
  - ElastiCache Redis: $30
  - Meilisearch Cloud (ou self-hosted): $0-50
  - Domaine + SSL: $2
  - Monitoring (Sentry, etc.): $30
  Total: ~$200-250/mois

DÃ©veloppement (6 mois MVP):
  - 1 Full-Stack Senior: $90k/an â†’ $45k (6 mois)
  - 1 DevOps Mid: $70k/an â†’ $35k
  - 1 UI/UX Junior: $50k/an â†’ $25k
  - 1 Product Owner: $80k/an â†’ $40k
  Total salaires: ~$145k (6 mois)

Outils & Licences:
  - GitHub Teams: $4/user/mois x 4 x 6 = $144
  - Figma Pro: $15/user/mois x 2 x 6 = $180
  - Autres SaaS: ~$500
  Total: ~$1000 (6 mois)

BUDGET TOTAL MVP: ~$150k (USD) pour 6 mois

10.4 MÃ‰TRIQUES DE SUCCÃˆS (KPIs)
-------------------------------

Techniques:
  âœ… Uptime > 99.9%
  âœ… Temps de rÃ©ponse API < 200ms (p95)
  âœ… Temps de chargement page < 2s
  âœ… Lighthouse score > 90
  âœ… 0 vulnÃ©rabilitÃ©s critiques

Business:
  âœ… 1000 documents en ligne (mois 6)
  âœ… 10,000 visiteurs uniques/mois (mois 12)
  âœ… 50,000 consultations/mois (mois 12)
  âœ… Taux de satisfaction > 80%
  âœ… NPS (Net Promoter Score) > 50

QualitÃ©:
  âœ… Test coverage > 80%
  âœ… 0 bugs critiques en production
  âœ… Temps de rÃ©solution bugs < 24h
  âœ… Documentation complÃ¨te et Ã  jour

================================================================================
11. CONFORMITÃ‰ ET LÃ‰GAL
================================================================================

11.1 PROPRIÃ‰TÃ‰ INTELLECTUELLE
------------------------------

Droits d'auteur:
  - Les auteurs conservent leurs droits sur leurs travaux
  - Licence de diffusion accordÃ©e Ã  la plateforme
  - Mention explicite de l'auteur sur chaque document
  - PossibilitÃ© de retrait Ã  la demande de l'auteur

Contrat de dÃ©pÃ´t:
  L'auteur autorise:
    âœ… La mise en ligne du document
    âœ… La consultation publique
    âœ… L'indexation par moteurs de recherche
    âœ… La conservation pÃ©renne
  
  L'auteur interdit:
    âŒ La modification du contenu
    âŒ L'usage commercial sans autorisation
    âŒ La reproduction totale sans citation

Licence recommandÃ©e: Creative Commons BY-NC-ND
  - Attribution (BY): Citer l'auteur
  - Non Commercial (NC): Pas d'usage commercial
  - No Derivatives (ND): Pas de modification

11.2 MENTIONS LÃ‰GALES
---------------------

Informations obligatoires:
  - Nom de l'organisme Ã©diteur
  - Adresse du siÃ¨ge social
  - NumÃ©ro SIRET/SIREN
  - Directeur de publication
  - HÃ©bergeur (nom, adresse)
  - Contact (email, tÃ©lÃ©phone)

ResponsabilitÃ©:
  - Clause de non-responsabilitÃ© contenu
  - Clause de disponibilitÃ© du service
  - Clause de propriÃ©tÃ© intellectuelle

11.3 POLITIQUE DE CONFIDENTIALITÃ‰
----------------------------------

DonnÃ©es collectÃ©es:
  Visiteurs:
    - IP (anonymisÃ©e aprÃ¨s 30j)
    - Pays/Ville (gÃ©olocalisation IP)
    - Historique de consultation (90j)
    - Recherches effectuÃ©es (90j)
  
  Administrateurs:
    - Email, nom, prÃ©nom
    - Logs d'activitÃ© (1 an)

Base lÃ©gale:
  - Consentement (cookies)
  - IntÃ©rÃªt lÃ©gitime (statistiques)
  - Obligation lÃ©gale (logs de sÃ©curitÃ©)

Droits des personnes:
  - Droit d'accÃ¨s
  - Droit de rectification
  - Droit Ã  l'effacement
  - Droit d'opposition
  - Droit Ã  la portabilitÃ©

Conservation des donnÃ©es:
  - Visiteurs: 90 jours
  - Administrateurs: DurÃ©e du contrat + 5 ans
  - Documents: IllimitÃ© (archivage patrimonial)

11.4 CONDITIONS GÃ‰NÃ‰RALES D'UTILISATION
----------------------------------------

AccÃ¨s au service:
  - Gratuit et libre
  - RÃ©servÃ© Ã  un usage personnel et non commercial
  - Interdit: scraping, tÃ©lÃ©chargement massif, revente

ResponsabilitÃ©s:
  - Plateforme: HÃ©bergement et mise Ã  disposition
  - Auteurs: Exactitude du contenu
  - Utilisateurs: Usage conforme

Suspension du compte:
  - En cas d'abus (admin)
  - En cas de violation des CGU

11.5 ACCESSIBILITÃ‰ NUMÃ‰RIQUE
-----------------------------

ConformitÃ© WCAG 2.1 niveau AA:
  âœ… Contrastes suffisants
  âœ… Navigation au clavier
  âœ… Lecteurs d'Ã©cran compatibles
  âœ… Textes alternatifs
  âœ… ARIA labels

DÃ©claration d'accessibilitÃ©:
  - Page dÃ©diÃ©e
  - Niveau de conformitÃ©
  - Contact pour signaler des problÃ¨mes

11.6 COOKIES ET TRACEURS
-------------------------

Types de cookies:
  - Essentiels (auth admin): DurÃ©e session
  - PrÃ©fÃ©rences (dark mode, langue): 1 an
  - Statistiques (analytics): 13 mois
  - Marketing: Aucun

BanniÃ¨re de consentement:
  - AffichÃ©e Ã  la premiÃ¨re visite
  - Choix granulaire (accepter/refuser par type)
  - PossibilitÃ© de modifier Ã  tout moment
  - ConformitÃ© ePrivacy

================================================================================
12. MONITORING ET MAINTENANCE
================================================================================

12.1 MONITORING APPLICATIF
---------------------------

MÃ©triques Ã  surveiller:
  - Uptime (disponibilitÃ©)
  - Temps de rÃ©ponse API
  - Taux d'erreur
  - Utilisation CPU/RAM/Disque
  - Nombre de requÃªtes/seconde
  - Taille de la queue (Celery/Bull)
  - Latence base de donnÃ©es
  - Cache hit rate (Redis)

Outils:
  - Prometheus: Collecte mÃ©triques
  - Grafana: Dashboards visuels
  - Sentry: Tracking erreurs
  - Winston: Logs applicatifs
  - AWS CloudWatch: Infrastructure

Alertes:
  - Uptime < 99%: Notification immÃ©diate
  - Erreurs > 5%: Notification 5 min
  - Temps rÃ©ponse > 2s: Notification 10 min
  - Disque > 80%: Notification 1h
  - Queue > 1000 jobs: Notification 10 min

12.2 BACKUPS
------------

Base de donnÃ©es (PostgreSQL):
  - Full backup: Quotidien Ã  2h du matin
  - Incremental backup: Toutes les 6h
  - RÃ©tention: 30 jours
  - Stockage: AWS S3 (diffÃ©rente rÃ©gion)
  - Tests de restauration: Mensuel

Fichiers (S3):
  - Versioning activÃ©
  - Cross-region replication
  - Lifecycle: Glacier aprÃ¨s 1 an
  - RÃ©tention: IllimitÃ©e

Configuration:
  - Code: Git (GitHub/GitLab)
  - Secrets: AWS Secrets Manager
  - Infrastructure as Code: Terraform
  - Backup: Quotidien

12.3 PLAN DE REPRISE D'ACTIVITÃ‰ (PRA)
--------------------------------------

RTO (Recovery Time Objective): 4 heures
RPO (Recovery Point Objective): 1 heure

ScÃ©narios de disaster:
  1. Panne serveur web â†’ Basculement auto-scaling
  2. Panne base de donnÃ©es â†’ Basculement replica
  3. Panne rÃ©gion AWS â†’ Basculement rÃ©gion secondaire
  4. Corruption donnÃ©es â†’ Restauration backup

ProcÃ©dure:
  1. DÃ©tection incident (monitoring)
  2. Alerte Ã©quipe (PagerDuty)
  3. Diagnostic (runbook)
  4. Activation PRA si nÃ©cessaire
  5. Communication utilisateurs (status page)
  6. Restauration
  7. Post-mortem

12.4 MAINTENANCE PRÃ‰VENTIVE
---------------------------

Hebdomadaire:
  âœ… Revue logs d'erreurs
  âœ… VÃ©rification alertes
  âœ… Mise Ã  jour dÃ©pendances mineures

Mensuelle:
  âœ… Audit de sÃ©curitÃ©
  âœ… Test de restauration backup
  âœ… Revue performance
  âœ… Nettoyage donnÃ©es obsolÃ¨tes
  âœ… Mise Ã  jour documentation

Trimestrielle:
  âœ… Mise Ã  jour majeure dÃ©pendances
  âœ… Revue architecture
  âœ… Optimisation base de donnÃ©es
  âœ… Audit RGPD

Annuelle:
  âœ… Pentest (test intrusion)
  âœ… Audit code complet
  âœ… Revue infrastructure
  âœ… Plan de capacitÃ©

12.5 GESTION DES INCIDENTS
---------------------------

Niveaux de sÃ©vÃ©ritÃ©:
  - P0 (Critique): Site down, perte de donnÃ©es
  - P1 (Majeure): FonctionnalitÃ© principale cassÃ©e
  - P2 (Mineure): Bug affectant peu d'utilisateurs
  - P3 (CosmÃ©tique): ProblÃ¨me visuel sans impact

SLA (Service Level Agreement):
  - P0: RÃ©solution < 4h
  - P1: RÃ©solution < 24h
  - P2: RÃ©solution < 1 semaine
  - P3: RÃ©solution < 1 mois

Workflow:
  1. DÃ©tection (monitoring ou signalement)
  2. Triage (sÃ©vÃ©ritÃ©, assignation)
  3. Investigation
  4. Correction
  5. DÃ©ploiement
  6. VÃ©rification
  7. Post-mortem (P0/P1)

================================================================================
13. CONCLUSION
================================================================================

Ce document de contexte fournit une vue d'ensemble complÃ¨te du projet de 
bibliothÃ¨que numÃ©rique acadÃ©mique. Il couvre:

âœ… Objectifs et cibles
âœ… Stack technique moderne et scalable
âœ… FonctionnalitÃ©s dÃ©taillÃ©es
âœ… Architecture base de donnÃ©es
âœ… SÃ©curitÃ© robuste
âœ… ExpÃ©rience utilisateur optimale
âœ… Roadmap d'Ã©volution
âœ… Plan de dÃ©veloppement
âœ… ConformitÃ© lÃ©gale
âœ… Monitoring et maintenance

Le projet est conÃ§u pour Ãªtre:
  - SÃ©curisÃ© (lecture seule, protection contenu)
  - Performant (recherche <50ms, chargement <2s)
  - Scalable (support de millions de documents)
  - Maintenable (code clean, documentation)
  - Ã‰volutif (roadmap IA, mobile, API)

Technologies clÃ©s:
  Frontend: Next.js + TypeScript + Tailwind
  Backend: NestJS + Prisma + PostgreSQL
  Recherche: Meilisearch
  Stockage: AWS S3
  SÃ©curitÃ©: JWT + Rate Limiting + PDF.js custom

Prochaines Ã©tapes:
  1. Validation du contexte avec les parties prenantes
  2. Constitution de l'Ã©quipe
  3. Lancement Sprint 0 (setup)
  4. DÃ©veloppement MVP (6 mois)
  5. Lancement pilote
  6. ItÃ©rations et amÃ©liorations

================================================================================
CONTACT
================================================================================

Pour toute question ou clarification concernant ce document, contacter:
  - Chef de projet: [Ã€ dÃ©finir]
  - Architecte technique: [Ã€ dÃ©finir]
  - Email: [Ã€ dÃ©finir]

Version: 1.0.0
Date: Janvier 2025
Statut: ApprouvÃ© / En attente de validation

================================================================================
FIN DU DOCUMENT
================================================================================